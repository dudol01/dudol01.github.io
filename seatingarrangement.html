<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ ë°˜ ìë¦¬ ë°°ì¹˜ í”„ë¡œê·¸ë¨ (ìì„ ì •ë ¬)</title>
    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ --- */
        :root {
            --bg-color: #f0f4f8;
            --sidebar-width: 300px;
            --desk-color: #f3d299;
            --desk-border: #d4a76a;
            --accent-color: #4a90e2;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: var(--bg-color);
            overflow: hidden;
        }

        /* ì™¼ìª½ ì‚¬ì´ë“œë°” */
        #sidebar {
            width: var(--sidebar-width);
            background: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        h2 { margin-top: 0; color: #333; }

        .control-group {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }

        input[type="number"] {
            width: 60px;
            padding: 5px;
            font-size: 16px;
        }

        button {
            padding: 8px 15px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        button:hover { background-color: #357abd; }
        
        button.secondary {
            background-color: #2ecc71;
            width: 100%;
            font-size: 18px;
            font-weight: bold;
            padding: 15px;
            margin-top: 10px;
        }

        button.secondary:hover { background-color: #27ae60; }

        #student-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .student-input-row {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .student-input-row span {
            width: 30px;
            font-weight: bold;
            color: #666;
        }

        .student-input-row input {
            flex: 1;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        /* ì˜¤ë¥¸ìª½ êµì‹¤ ì˜ì—­ */
        #classroom {
            flex: 1;
            position: relative;
            background-color: #eaddcf;
            background-image: radial-gradient(#d6c4b0 15%, transparent 16%),
                              radial-gradient(#d6c4b0 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            overflow: hidden;
        }

        #blackboard {
            width: 60%;
            height: 40px;
            background-color: #2c3e50;
            border: 5px solid #8e44ad;
            border-radius: 0 0 10px 10px;
            margin: 0 auto;
            color: white;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        /* ì±…ìƒ ìŠ¤íƒ€ì¼ */
        .desk {
            width: 100px;
            height: 60px;
            background-color: var(--desk-color);
            border: 2px solid var(--desk-border);
            border-radius: 8px;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #333;
            cursor: grab;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            user-select: none;
            z-index: 1;
            /* ìœ„ì¹˜ ì´ë™ ì‹œ ë¶€ë“œëŸ¬ìš´ íš¨ê³¼ (ë“œë˜ê·¸ ì¤‘ì—ëŠ” JSë¡œ ì œê±°í•¨) */
            transition: transform 0.1s; 
        }

        /* ë“œë˜ê·¸ í›„ ìì„ì²˜ëŸ¼ ë¶™ì„ ë•Œ ë¶€ë“œëŸ½ê²Œ ì´ë™í•˜ëŠ” í´ë˜ìŠ¤ */
        .desk.snapping {
            transition: left 0.3s ease-out, top 0.3s ease-out, transform 0.1s;
        }

        .desk:active {
            cursor: grabbing;
            transform: scale(1.05);
            z-index: 100;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
        }

        .desk span {
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>ğŸª‘ ìë¦¬ ë°°ì¹˜</h2>
        
        <div class="control-group">
            <label>í•™ìƒ ìˆ˜: </label>
            <input type="number" id="student-count" value="12" min="1" max="50">
            <button onclick="initClass()">ì„¤ì •</button>
        </div>

        <div id="student-list">
            <p style="color:#888; text-align:center;">í•™ìƒ ìˆ˜ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
        </div>

        <div class="control-group" style="border:none;">
            <button class="secondary" onclick="assignSeats()">ğŸ² ìë¦¬ ë°°ì •í•˜ê¸°</button>
            <div style="margin-top:10px; text-align: center; font-size: 12px; color: #666;">
                * ì±…ìƒì„ ë†“ìœ¼ë©´ ì¤„ì— ë§ì¶° ìë™ ì •ë ¬ë©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <div id="classroom">
        <div id="blackboard">ì¹  íŒ</div>
    </div>

    <script>
        /* --- Javascript ë¡œì§ --- */

        // ì „ì—­ ì„¤ì • ë³€ìˆ˜ (ê·¸ë¦¬ë“œ ê°„ê²© ë° ì‹œì‘ ìœ„ì¹˜)
        let GRID_GAP_X = 140; // ê°€ë¡œ ê°„ê²©
        let GRID_GAP_Y = 80;  // ì„¸ë¡œ ê°„ê²©
        let GRID_START_X = 0; // êµì‹¤ ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ initClassì—ì„œ ê³„ì‚°ë¨
        let GRID_START_Y = 100; // ì¹ íŒ ì•„ë˜ ì‹œì‘ì 

        const lastNames = ['ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ ', 'ê¶Œ', 'í™©', 'ì•ˆ', 'ì†¡', 'ë¥˜', 'ì „'];
        const firstNames = ['ë¯¼ì¤€', 'ì„œì¤€', 'ë„ìœ¤', 'ì˜ˆì¤€', 'ì‹œìš°', 'í•˜ì¤€', 'ì§€í˜¸', 'ì£¼ì›', 'ì§€ìš°', 'ì„œí˜„', 'ì„œì—°', 'ì§€ìœ ', 'ì§€ì•„', 'ìˆ˜ì•„', 'ì†Œì€', 'í•˜ì€', 'ìœ ì§„', 'ë¯¼ì„œ', 'ì±„ì›', 'ë‹¤ì€'];

        function getRandomName() {
            const last = lastNames[Math.floor(Math.random() * lastNames.length)];
            const first = firstNames[Math.floor(Math.random() * firstNames.length)];
            return last + first;
        }

        function initClass() {
            const count = document.getElementById('student-count').value;
            const listContainer = document.getElementById('student-list');
            const classroom = document.getElementById('classroom');
            
            listContainer.innerHTML = '';
            const existingDesks = document.querySelectorAll('.desk');
            existingDesks.forEach(desk => desk.remove());

            // 1. í•™ìƒ ëª…ë‹¨ ìƒì„±
            for (let i = 1; i <= count; i++) {
                const row = document.createElement('div');
                row.className = 'student-input-row';
                
                const numSpan = document.createElement('span');
                numSpan.textContent = i + '.';
                
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.value = getRandomName();
                nameInput.className = 'student-name-input';
                nameInput.placeholder = 'ì´ë¦„';

                row.appendChild(numSpan);
                row.appendChild(nameInput);
                listContainer.appendChild(row);
            }

            // 2. ì±…ìƒ ë°°ì¹˜ ê¸°ì¤€ì  ê³„ì‚°
            const cols = 2; // ê¸°ë³¸ 2ë¶„ë‹¨
            const classroomWidth = classroom.clientWidth;
            // ì±…ìƒ í­ 100pxì„ ê³ ë ¤í•˜ì—¬ ê·¸ë£¹ ì „ì²´ ë„ˆë¹„ ê³„ì‚°
            const groupWidth = (cols - 1) * GRID_GAP_X + 100; 
            
            // ì „ì—­ ë³€ìˆ˜ì— ì‹œì‘ì  ì €ì¥ (ì¤‘ìš”: ë“œë˜ê·¸ ì‹œ ì´ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ìì„ ê¸°ëŠ¥ ì‘ë™)
            GRID_START_X = (classroomWidth - groupWidth) / 2;

            for (let i = 0; i < count; i++) {
                const desk = document.createElement('div');
                desk.className = 'desk';
                desk.id = 'desk-' + i;
                
                const colIndex = i % cols; 
                const rowIndex = Math.floor(i / cols);

                const x = GRID_START_X + (colIndex * GRID_GAP_X);
                const y = GRID_START_Y + (rowIndex * GRID_GAP_Y);

                desk.style.left = x + 'px';
                desk.style.top = y + 'px';
                desk.innerHTML = `<span>ì±…ìƒ ${i + 1}</span>`;
                
                classroom.appendChild(desk);
                makeDraggable(desk);
            }
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ + ìì„ ê¸°ëŠ¥(Snap to Grid)
        function makeDraggable(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            elmnt.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ë¶€ë“œëŸ¬ìš´ ì´ë™ íš¨ê³¼ ì œê±° (ì¦‰ê°ì ì¸ ë°˜ì‘ì„ ìœ„í•´)
                elmnt.classList.remove('snapping');
                
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;

                // --- ìì„(Snap) ë¡œì§ ì‹œì‘ ---
                // í˜„ì¬ ìœ„ì¹˜ì—ì„œ ì‹œì‘ì (GRID_START)ì„ ëº€ ê°’ì„ ê²©ì ê°„ê²©(GRID_GAP)ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë°˜ì˜¬ë¦¼
                // ì´ë ‡ê²Œ í•˜ë©´ ê°€ì¥ ê°€ê¹Œìš´ 'ì¹¸'ì˜ ì¸ë±ìŠ¤(0, 1, 2...)ê°€ ë‚˜ì˜µë‹ˆë‹¤.
                let colIndex = Math.round((elmnt.offsetLeft - GRID_START_X) / GRID_GAP_X);
                let rowIndex = Math.round((elmnt.offsetTop - GRID_START_Y) / GRID_GAP_Y);

                // ì¸ë±ìŠ¤ë¥¼ ë‹¤ì‹œ ì¢Œí‘œë¡œ ë³€í™˜
                let newLeft = GRID_START_X + (colIndex * GRID_GAP_X);
                let newTop = GRID_START_Y + (rowIndex * GRID_GAP_Y);

                // í™”ë©´ ë°–ìœ¼ë¡œ ë„ˆë¬´ ë©€ë¦¬ ë‚˜ê°€ì§€ ì•Šê²Œ ìµœì†Œê°’ ì œí•œ (ì„ íƒì‚¬í•­)
                if (rowIndex < 0) newTop = GRID_START_Y; // ì¹ íŒ ìœ„ë¡œëŠ” ëª» ê°€ê²Œ

                // ë¶€ë“œëŸ¬ìš´ ì´ë™ íš¨ê³¼ ì¶”ê°€
                elmnt.classList.add('snapping');
                
                // ìœ„ì¹˜ í™•ì •
                elmnt.style.left = newLeft + "px";
                elmnt.style.top = newTop + "px";
                // --- ìì„ ë¡œì§ ë ---
            }
        }

        function assignSeats() {
            const inputs = document.querySelectorAll('.student-name-input');
            let names = [];
            inputs.forEach(input => {
                if(input.value.trim() !== "") {
                    names.push(input.value.trim());
                } else {
                    names.push("(ê³µì„)");
                }
            });

            for (let i = names.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [names[i], names[j]] = [names[j], names[i]];
            }

            const desks = document.querySelectorAll('.desk');
            
            // ì• ë‹ˆë©”ì´ì…˜: ì ê¹ ë’¤ì§‘ëŠ” íš¨ê³¼ì²˜ëŸ¼ í…ìŠ¤íŠ¸ ìˆ¨ê¹€
            desks.forEach(desk => {
                desk.style.transition = 'background-color 0.3s';
                desk.style.backgroundColor = '#fff';
                desk.innerText = '...';
            });

            setTimeout(() => {
                desks.forEach((desk, index) => {
                    if (index < names.length) {
                        desk.style.backgroundColor = 'var(--desk-color)';
                        desk.innerText = names[index];
                    }
                });
            }, 300);
        }

        window.onload = initClass;
        window.addEventListener('resize', initClass); // ì°½ í¬ê¸° ì¡°ì ˆ ì‹œ ì¬ì •ë ¬
    </script>
</body>
</html>
