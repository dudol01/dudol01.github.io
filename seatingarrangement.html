<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ ë°˜ ìë¦¬ ë°°ì¹˜ í”„ë¡œê·¸ë¨</title>
    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ --- */
        :root {
            --bg-color: #f0f4f8;
            --sidebar-width: 300px;
            --desk-color: #f3d299;
            --desk-border: #d4a76a;
            --accent-color: #4a90e2;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: var(--bg-color);
            overflow: hidden;
        }

        /* ì™¼ìª½ ì‚¬ì´ë“œë°” (ì„¤ì • ë° ëª…ë ¬í‘œ) */
        #sidebar {
            width: var(--sidebar-width);
            background: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        h2 { margin-top: 0; color: #333; }

        .control-group {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }

        input[type="number"] {
            width: 60px;
            padding: 5px;
            font-size: 16px;
        }

        button {
            padding: 8px 15px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        button:hover { background-color: #357abd; }
        
        button.secondary {
            background-color: #2ecc71;
            width: 100%;
            font-size: 18px;
            font-weight: bold;
            padding: 15px;
            margin-top: 10px;
        }

        button.secondary:hover { background-color: #27ae60; }

        #student-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .student-input-row {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .student-input-row span {
            width: 30px;
            font-weight: bold;
            color: #666;
        }

        .student-input-row input {
            flex: 1;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        /* ì˜¤ë¥¸ìª½ êµì‹¤ ì˜ì—­ */
        #classroom {
            flex: 1;
            position: relative;
            background-color: #eaddcf; /* ë§ˆë£»ë°”ë‹¥ ìƒ‰ìƒ ëŠë‚Œ */
            background-image: radial-gradient(#d6c4b0 15%, transparent 16%),
                              radial-gradient(#d6c4b0 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            overflow: hidden;
        }

        #blackboard {
            width: 60%;
            height: 40px;
            background-color: #2c3e50;
            border: 5px solid #8e44ad;
            border-radius: 0 0 10px 10px;
            margin: 0 auto;
            color: white;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        /* ì±…ìƒ ìŠ¤íƒ€ì¼ */
        .desk {
            width: 100px;
            height: 60px;
            background-color: var(--desk-color);
            border: 2px solid var(--desk-border);
            border-radius: 8px;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #333;
            cursor: grab;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            user-select: none; /* ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
            transition: transform 0.1s;
            z-index: 1;
        }

        .desk:active {
            cursor: grabbing;
            transform: scale(1.05);
            z-index: 100; /* ë“œë˜ê·¸ ì¤‘ì¸ ìš”ì†Œë¥¼ ìµœìƒìœ„ë¡œ */
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
        }

        .desk span {
            pointer-events: none; /* í…ìŠ¤íŠ¸ê°€ ë“œë˜ê·¸ ë°©í•´í•˜ì§€ ì•Šë„ë¡ */
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>ğŸª‘ ìë¦¬ ë°°ì¹˜</h2>
        
        <div class="control-group">
            <label>í•™ìƒ ìˆ˜: </label>
            <input type="number" id="student-count" value="12" min="1" max="50">
            <button onclick="initClass()">ì„¤ì •</button>
        </div>

        <div id="student-list">
            <p style="color:#888; text-align:center;">í•™ìƒ ìˆ˜ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
        </div>

        <div class="control-group" style="border:none;">
            <button class="secondary" onclick="assignSeats()">ğŸ² ìë¦¬ ë°°ì •í•˜ê¸°</button>
            <div style="margin-top:10px; text-align: center; font-size: 12px; color: #666;">
                * ì±…ìƒì„ ë“œë˜ê·¸í•˜ì—¬ ë°°ì¹˜ë¥¼ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <div id="classroom">
        <div id="blackboard">ì¹  íŒ</div>
        </div>

    <script>
        /* --- Javascript ë¡œì§ --- */

        // ëœë¤ ì´ë¦„ ìƒì„±ì„ ìœ„í•œ ë°ì´í„°
        const lastNames = ['ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ ', 'ê¶Œ', 'í™©', 'ì•ˆ', 'ì†¡', 'ë¥˜', 'ì „'];
        const firstNames = ['ë¯¼ì¤€', 'ì„œì¤€', 'ë„ìœ¤', 'ì˜ˆì¤€', 'ì‹œìš°', 'í•˜ì¤€', 'ì§€í˜¸', 'ì£¼ì›', 'ì§€ìš°', 'ì„œí˜„', 'ì„œì—°', 'ì§€ìœ ', 'ì§€ì•„', 'ìˆ˜ì•„', 'ì†Œì€', 'í•˜ì€', 'ìœ ì§„', 'ë¯¼ì„œ', 'ì±„ì›', 'ë‹¤ì€'];

        // ëœë¤ ì´ë¦„ ìƒì„± í•¨ìˆ˜
        function getRandomName() {
            const last = lastNames[Math.floor(Math.random() * lastNames.length)];
            const first = firstNames[Math.floor(Math.random() * firstNames.length)];
            return last + first;
        }

        // ì´ˆê¸°í™” ë° ì…ë ¥ì°½/ì±…ìƒ ìƒì„±
        function initClass() {
            const count = document.getElementById('student-count').value;
            const listContainer = document.getElementById('student-list');
            const classroom = document.getElementById('classroom');
            
            // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™” (ì¹ íŒ ì œì™¸)
            listContainer.innerHTML = '';
            // ì¹ íŒì€ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€(ì±…ìƒ) ì œê±°
            const existingDesks = document.querySelectorAll('.desk');
            existingDesks.forEach(desk => desk.remove());

            // 1. í•™ìƒ ëª…ë‹¨ ì…ë ¥ì°½ ìƒì„±
            for (let i = 1; i <= count; i++) {
                const row = document.createElement('div');
                row.className = 'student-input-row';
                
                const numSpan = document.createElement('span');
                numSpan.textContent = i + '.';
                
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.value = getRandomName(); // ì´ˆê¸° ëœë¤ ì´ë¦„
                nameInput.className = 'student-name-input';
                nameInput.placeholder = 'ì´ë¦„';

                row.appendChild(numSpan);
                row.appendChild(nameInput);
                listContainer.appendChild(row);
            }

            // 2. ì±…ìƒ ìƒì„± ë° ê¸°ë³¸ ë°°ì¹˜ (6ì—´ 2í–‰ ê¸°ì¤€, í•˜ì§€ë§Œ í•™ìƒ ìˆ˜ì— ë”°ë¼ ìœ ë™ì ìœ¼ë¡œ)
            // ìš”êµ¬ì‚¬í•­: ê¸°ë³¸ 2ê°œì˜ ì±…ìƒ ë°°ì¹˜ (2ì—´). 
            // ê°€ë¡œ(ì—´) ê°œìˆ˜: 2, ì„¸ë¡œ(í–‰) ê°œìˆ˜: í•™ìƒìˆ˜ / 2
            
            const cols = 2; // ë¶„ë‹¨ ìˆ˜
            const startX = 200; // ì‹œì‘ X ìœ„ì¹˜ (í™”ë©´ ì¤‘ì•™ ì¦ˆìŒ)
            const startY = 100; // ì‹œì‘ Y ìœ„ì¹˜
            const gapX = 140;   // ê°€ë¡œ ê°„ê²©
            const gapY = 80;    // ì„¸ë¡œ ê°„ê²©

            // êµì‹¤ ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ê³„ì‚°
            const classroomWidth = classroom.clientWidth;
            const groupWidth = (cols - 1) * gapX + 100; // 100ì€ ì±…ìƒ í­
            const initialOffsetX = (classroomWidth - groupWidth) / 2;

            for (let i = 0; i < count; i++) {
                const desk = document.createElement('div');
                desk.className = 'desk';
                desk.id = 'desk-' + i;
                
                // ê·¸ë¦¬ë“œ ë°°ì¹˜ ê³„ì‚° (2ì—´ ì¢…ëŒ€)
                const colIndex = i % cols; 
                const rowIndex = Math.floor(i / cols);

                const x = initialOffsetX + (colIndex * gapX);
                const y = startY + (rowIndex * gapY);

                desk.style.left = x + 'px';
                desk.style.top = y + 'px';
                
                // ì´ˆê¸°ì—ëŠ” ë²ˆí˜¸ë§Œ í‘œì‹œ
                desk.innerHTML = `<span>ì±…ìƒ ${i + 1}</span>`;
                
                classroom.appendChild(desk);
                
                // ë“œë˜ê·¸ ê¸°ëŠ¥ ë¶€ì—¬
                makeDraggable(desk);
            }
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ êµ¬í˜„
        function makeDraggable(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            elmnt.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // ë§ˆìš°ìŠ¤ ì‹œì‘ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                // ë§ˆìš°ìŠ¤ê°€ ì›€ì§ì¼ ë•Œì™€ ë©ˆì·„ì„ ë•Œ ì´ë²¤íŠ¸ ì—°ê²°
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                
                // ì´ë™ ê±°ë¦¬ ê³„ì‚°
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                // ìš”ì†Œì˜ ìƒˆ ìœ„ì¹˜ ì„¤ì •
                let newTop = elmnt.offsetTop - pos2;
                let newLeft = elmnt.offsetLeft - pos1;

                // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šë„ë¡ ê²½ê³„ ì„¤ì • (ì„ íƒì‚¬í•­)
                // const parent = elmnt.parentElement;
                // if(newTop < 0) newTop = 0;
                // if(newLeft < 0) newLeft = 0;
                
                elmnt.style.top = newTop + "px";
                elmnt.style.left = newLeft + "px";
            }

            function closeDragElement() {
                // ë§ˆìš°ìŠ¤ ë²„íŠ¼ì„ ë†“ìœ¼ë©´ ì´ë²¤íŠ¸ í•´ì œ
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        // ìë¦¬ ë°°ì • ë¡œì§ (Fisher-Yates Shuffle)
        function assignSeats() {
            // 1. í˜„ì¬ ì…ë ¥ëœ í•™ìƒ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
            const inputs = document.querySelectorAll('.student-name-input');
            let names = [];
            inputs.forEach(input => {
                if(input.value.trim() !== "") {
                    names.push(input.value.trim());
                } else {
                    names.push("(ê³µì„)");
                }
            });

            // 2. ì´ë¦„ ì„ê¸°
            for (let i = names.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [names[i], names[j]] = [names[j], names[i]];
            }

            // 3. ì±…ìƒì— ì´ë¦„ ë„£ê¸°
            const desks = document.querySelectorAll('.desk');
            
            // ì±…ìƒ ê°œìˆ˜ì™€ í•™ìƒ ìˆ˜ ì¤‘ ì‘ì€ ìˆ˜ë§Œí¼ ë°˜ë³µ
            const count = Math.min(desks.length, names.length);

            // ê°„ë‹¨í•œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ìœ„í•´ ì ì‹œ ë‚´ìš© ì§€ìš°ê¸°
            desks.forEach(desk => {
                desk.style.backgroundColor = '#fff';
                desk.innerText = '...';
            });

            setTimeout(() => {
                desks.forEach((desk, index) => {
                    if (index < names.length) {
                        desk.style.backgroundColor = 'var(--desk-color)';
                        desk.innerText = names[index];
                    }
                });
            }, 300); // 0.3ì´ˆ ë”œë ˆì´ í›„ ì´ë¦„ ê³µê°œ
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ì‹¤í–‰
        window.onload = initClass;

    </script>
</body>
</html>
