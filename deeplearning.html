<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ëª¬ìŠ¤í„° ì—°êµ¬ì†Œ ğŸ‘¾</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C5CE7;
            --secondary: #00CEC9;
            --accent: #FAB1A0;
            --bg: #dfe6e9;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Jua', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ íƒ­ */
        .nav-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            z-index: 10;
        }

        .tab-btn {
            background: #b2bec3;
            border: none;
            padding: 15px 30px;
            font-size: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            font-family: 'Jua';
            transition: all 0.3s;
            box-shadow: 0 5px 0 #636e72;
        }

        .tab-btn.active {
            background: var(--primary);
            transform: translateY(5px);
            box-shadow: none;
        }

        /* ë©”ì¸ ê²Œì„ í™”ë©´ */
        .game-screen {
            background: var(--card-bg);
            width: 90%;
            max-width: 800px;
            height: 600px;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            display: none; /* JSë¡œ ì œì–´ */
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }

        .game-screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            animation: fadeIn 0.5s;
        }

        h2 { font-size: 2rem; color: #2d3436; margin: 0; }
        p { font-size: 1.2rem; color: #636e72; }

        /* --- STAGE 1: ë°ì´í„° ìˆ˜ì§‘ --- */
        .data-collection-area {
            display: flex;
            gap: 20px;
            width: 100%;
            justify-content: center;
        }

        .monster-card {
            border: 4px dashed #bdc3c7;
            border-radius: 20px;
            padding: 20px;
            width: 200px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .monster-card:active { transform: scale(0.95); background: #f1f2f6; }
        
        .monster-emoji { font-size: 80px; }
        .data-count { font-size: 1.5rem; color: var(--primary); font-weight: bold; }

        /* --- STAGE 2: í›ˆë ¨ (ê·¸ë˜í”„) --- */
        .training-visual {
            width: 80%;
            height: 200px;
            background: #2d3436;
            border-radius: 10px;
            position: relative;
            display: flex;
            align-items: flex-end;
            padding: 10px;
            gap: 5px;
            overflow: hidden;
        }

        .loss-bar {
            flex: 1;
            background: var(--accent);
            border-radius: 5px 5px 0 0;
            transition: height 0.5s;
        }
        
        .brain-container { font-size: 100px; margin: 20px; animation: float 3s infinite ease-in-out; }
        
        #train-btn {
            background: var(--secondary);
            font-size: 2rem;
            padding: 20px 60px;
            border-radius: 50px;
            border: none;
            color: white;
            cursor: pointer;
            box-shadow: 0 8px 0 #00b894;
            font-family: 'Jua';
        }
        #train-btn:active { transform: translateY(8px); box-shadow: none; }
        #train-btn:disabled { background: #b2bec3; box-shadow: none; cursor: not-allowed; }

        /* --- STAGE 3: ì‹¤ì „ í…ŒìŠ¤íŠ¸ --- */
        .test-zone {
            display: flex;
            align-items: center;
            gap: 50px;
        }
        .unknown-monster {
            font-size: 120px;
            background: #eee;
            border-radius: 50%;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 5px solid #bdc3c7;
        }
        .ai-thinking {
            font-size: 1.5rem;
            background: #fff;
            border: 3px solid var(--primary);
            padding: 20px;
            border-radius: 20px;
            position: relative;
            min-width: 200px;
        }
        /* ë§í’ì„  ê¼¬ë¦¬ */
        .ai-thinking::after {
            content: ''; position: absolute; left: -20px; top: 50%;
            border-width: 10px; border-style: solid;
            border-color: transparent var(--primary) transparent transparent;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .pulse { animation: pulse 0.2s; }

        /* ê²°ê³¼ ëª¨ë‹¬ */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex; justify-content: center; align-items: center;
            z-index: 100;
        }
        .hidden { display: none !important; }
        .modal-content {
            background: white; padding: 40px; border-radius: 20px; text-align: center;
            box-shadow: 0 0 30px rgba(255,255,255,0.5);
            animation: fadeIn 0.3s;
        }
        .modal-btn {
            background: var(--primary); color: white; border: none; padding: 10px 20px;
            font-size: 1.2rem; border-radius: 10px; cursor: pointer; font-family: 'Jua'; margin-top: 20px;
        }

    </style>
</head>
<body>

    <div class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab(1)">1. ë°ì´í„° ìˆ˜ì§‘ ğŸ“¸</button>
        <button class="tab-btn" onclick="switchTab(2)">2. AI ë‡Œ í›ˆë ¨ ğŸ§ </button>
        <button class="tab-btn" onclick="switchTab(3)">3. ì‹¤ì „ í…ŒìŠ¤íŠ¸ ğŸ®</button>
    </div>

    <div id="stage-1" class="game-screen active">
        <h2>STEP 1: ëª¬ìŠ¤í„° ì‚¬ì§„ì„ ëª¨ì•„ì£¼ì„¸ìš”!</h2>
        <p>AIëŠ” ì•„ì§ ì•„ëŠ” ê²Œ ì—†ì–´ìš”. ì¹´ë“œë¥¼ í´ë¦­í•´ì„œ ë°ì´í„°ë¥¼ "ëƒ ëƒ " ë¨¹ì—¬ì£¼ì„¸ìš”.</p>
        
        <div class="data-collection-area">
            <div class="monster-card" onclick="collectData('slime')">
                <div class="monster-emoji">ğŸ¦ </div>
                <h3>ìŠ¬ë¼ì„</h3>
                <div class="data-count">ìˆ˜ì§‘: <span id="count-slime">0</span>ì¥</div>
            </div>
            <div class="monster-card" onclick="collectData('ghost')">
                <div class="monster-emoji">ğŸ‘»</div>
                <h3>ìœ ë ¹</h3>
                <div class="data-count">ìˆ˜ì§‘: <span id="count-ghost">0</span>ì¥</div>
            </div>
            <div class="monster-card" onclick="collectData('alien')">
                <div class="monster-emoji">ğŸ‘¾</div>
                <h3>ì™¸ê³„ì¸</h3>
                <div class="data-count">ìˆ˜ì§‘: <span id="count-alien">0</span>ì¥</div>
            </div>
        </div>
        <p style="color: var(--primary); font-size: 1rem;">* ë°ì´í„°ê°€ ë§ì„ìˆ˜ë¡ ë‚˜ì¤‘ì— AIê°€ ë” ë˜‘ë˜‘í•´ì§‘ë‹ˆë‹¤! (ìµœì†Œ 10ì¥ì”© ëª¨ìœ¼ì„¸ìš”)</p>
    </div>

    <div id="stage-2" class="game-screen">
        <h2>STEP 2: ì˜¤ì°¨(Loss)ë¥¼ ì¤„ì—¬ë¼!</h2>
        <p>ë²„íŠ¼ì„ ì—°íƒ€í•´ì„œ AIì˜ ë‡Œë¥¼ í›ˆë ¨ì‹œí‚¤ì„¸ìš”! ê·¸ë˜í”„ê°€ ë°”ë‹¥ìœ¼ë¡œ ë‚´ë ¤ê°€ì•¼ í•©ë‹ˆë‹¤.</p>
        
        <div class="brain-container" id="brain">ğŸ§ </div>
        
        <div class="training-visual" id="loss-chart">
            </div>
        
        <div style="margin-top: 20px;">
            <p>í˜„ì¬ ì˜¤ì°¨ìœ¨: <span id="loss-value" style="color:red; font-size:1.5rem;">100</span>%</p>
            <p>í˜„ì¬ ì§€ëŠ¥(Epoch): <span id="epoch-value">0</span> ì„¸ëŒ€</p>
        </div>

        <button id="train-btn" onclick="trainAI()">âš¡ í›ˆë ¨í•˜ê¸° (í´ë¦­!)</button>
    </div>

    <div id="stage-3" class="game-screen">
        <h2>STEP 3: ëª¬ìŠ¤í„° ì •ì²´ ë°íˆê¸°</h2>
        <p>í›ˆë ¨ëœ AIê°€ ëª¬ìŠ¤í„°ë¥¼ ë³´ê³  ì •ì²´ë¥¼ ì¶”ì¸¡í•©ë‹ˆë‹¤.</p>
        
        <div class="test-zone">
            <div class="unknown-monster" id="test-monster">â“</div>
            <div class="ai-thinking">
                <p id="ai-status">ìŒ... ë¶„ì„ ì¤‘...</p>
                <h1 id="ai-guess" style="color:var(--primary)">?</h1>
                <p id="ai-confidence" style="font-size:0.8rem; color:#b2bec3;">í™•ì‹ : 0%</p>
            </div>
        </div>

        <button class="tab-btn" style="background:#00b894; margin-top:30px;" onclick="runTest()">ìƒˆë¡œìš´ ëª¬ìŠ¤í„° ë“±ì¥!</button>
    </div>

    <div id="alert-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="modal-msg">ë©”ì‹œì§€</h2>
            <button class="modal-btn" onclick="closeModal()">í™•ì¸</button>
        </div>
    </div>

    <script>
        // --- ê²Œì„ ìƒíƒœ ë³€ìˆ˜ ---
        let collectedData = { slime: 0, ghost: 0, alien: 0 };
        let totalData = 0;
        let currentLoss = 100; // ì˜¤ì°¨ìœ¨ (0ì´ ë˜ë©´ ì™„ë²½)
        let epoch = 0; // í›ˆë ¨ íšŸìˆ˜
        let isTrained = false;

        // --- íƒ­ ì „í™˜ ë¡œì§ ---
        function switchTab(tabNum) {
            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            // ì„ íƒëœ í™”ë©´ ë³´ì´ê¸°
            document.getElementById(`stage-${tabNum}`).classList.add('active');
            document.querySelectorAll('.tab-btn')[tabNum-1].classList.add('active');

            if (tabNum === 2) initTrainingChart();
        }

        // --- STAGE 1: ë°ì´í„° ìˆ˜ì§‘ ---
        function collectData(type) {
            collectedData[type]++;
            totalData++;
            document.getElementById(`count-${type}`).innerText = collectedData[type];
            
            // í´ë¦­ íš¨ê³¼
            const card = document.activeElement; // í´ë¦­ëœ ìš”ì†Œ
            // ì• ë‹ˆë©”ì´ì…˜ì€ CSS activeë¡œ ì²˜ë¦¬ë¨
        }

        // --- STAGE 2: í›ˆë ¨ (í•µì‹¬ ë¡œì§) ---
        function initTrainingChart() {
            const chart = document.getElementById('loss-chart');
            chart.innerHTML = '';
            // ì´ˆê¸° ë¹¨ê°„ ë§‰ëŒ€ë“¤ ìƒì„±
            for(let i=0; i<20; i++) {
                let bar = document.createElement('div');
                bar.className = 'loss-bar';
                bar.style.height = (Math.random() * 50 + 50) + '%'; // ë“¤ì‘¥ë‚ ì‘¥í•œ ì˜¤ì°¨
                chart.appendChild(bar);
            }
        }

        function trainAI() {
            // 1. ë°ì´í„°ê°€ ë„ˆë¬´ ì ìœ¼ë©´ í›ˆë ¨ ë¶ˆê°€
            if (totalData < 10) {
                showModal("ğŸš¨ ë°ì´í„° ë¶€ì¡±! 1ë‹¨ê³„ì—ì„œ ëª¬ìŠ¤í„°ë¥¼ 10ë§ˆë¦¬ ì´ìƒ ëª¨ì•„ì˜¤ì„¸ìš”.");
                return;
            }

            // 2. í›ˆë ¨ ì§„í–‰ (ì˜¤ì°¨ìœ¨ ê°ì†Œ)
            const btn = document.getElementById('train-btn');
            const brain = document.getElementById('brain');
            const lossText = document.getElementById('loss-value');
            const epochText = document.getElementById('epoch-value');
            const chart = document.getElementById('loss-chart');

            // ë‡Œê°€ ë‘ê·¼ê±°ë¦¬ëŠ” íš¨ê³¼
            brain.classList.remove('pulse');
            void brain.offsetWidth; // ë¦¬í”Œë¡œìš° ê°•ì œ (ì• ë‹ˆë©”ì´ì…˜ ë¦¬ì…‹ìš©)
            brain.classList.add('pulse');

            epoch++;
            epochText.innerText = epoch;

            // ì˜¤ì°¨ìœ¨ ê³„ì‚°: ë°ì´í„°ê°€ ë§ì„ìˆ˜ë¡ ë¹¨ë¦¬ ì¤„ì–´ë“¦
            let learningRate = (totalData / 5); // í•™ìŠµë¥ 
            currentLoss -= learningRate + (Math.random() * 5); // ëœë¤ì„± ì¶”ê°€
            if (currentLoss < 1) currentLoss = 1;

            lossText.innerText = Math.floor(currentLoss);

            // ê·¸ë˜í”„ ì‹œê°í™” (ì˜¤ë¥¸ìª½ìœ¼ë¡œ íë¥´ë©° ì¤„ì–´ë“œëŠ” ë§‰ëŒ€ ì¶”ê°€)
            let newBar = document.createElement('div');
            newBar.className = 'loss-bar';
            newBar.style.height = currentLoss + '%';
            newBar.style.background = currentLoss < 20 ? '#00b894' : '#FAB1A0'; // ì˜¤ì°¨ê°€ ì¤„ë©´ ì´ˆë¡ìƒ‰
            
            chart.appendChild(newBar);
            if(chart.children.length > 30) chart.removeChild(chart.firstChild); // ì˜¤ë˜ëœ ë§‰ëŒ€ ì‚­ì œ

            // 3. í›ˆë ¨ ì™„ë£Œ ì²´í¬
            if (currentLoss <= 10) {
                isTrained = true;
                showModal("ğŸ‰ í›ˆë ¨ ì™„ë£Œ! AIê°€ ë§¤ìš° ë˜‘ë˜‘í•´ì¡ŒìŠµë‹ˆë‹¤. 3ë‹¨ê³„ë¡œ ê°€ë³´ì„¸ìš”!");
                btn.style.background = "#00b894";
                btn.innerText = "í›ˆë ¨ ì™„ë£Œ (ìµœì í™”ë¨)";
            }
        }

        // --- STAGE 3: ì‹¤ì „ í…ŒìŠ¤íŠ¸ ---
        function runTest() {
            const monsterEl = document.getElementById('test-monster');
            const guessEl = document.getElementById('ai-guess');
            const statusEl = document.getElementById('ai-status');
            const confEl = document.getElementById('ai-confidence');

            // 1. ëœë¤ ëª¬ìŠ¤í„° ë“±ì¥
            const types = ['slime', 'ghost', 'alien'];
            const emojis = {'slime':'ğŸ¦ ', 'ghost':'ğŸ‘»', 'alien':'ğŸ‘¾'};
            const names = {'slime':'ìŠ¬ë¼ì„', 'ghost':'ìœ ë ¹', 'alien':'ì™¸ê³„ì¸'};
            
            const answer = types[Math.floor(Math.random() * types.length)];
            
            monsterEl.innerText = emojis[answer];
            monsterEl.style.animation = "pulse 0.5s";

            // 2. AI ìƒê° ì¤‘...
            statusEl.innerText = "ë°ì´í„° ìŠ¤ìº” ì¤‘...";
            guessEl.innerText = "???";
            confEl.innerText = "";

            setTimeout(() => {
                // 3. ê²°ê³¼ íŒì •
                if (!isTrained) {
                    // í›ˆë ¨ ì•ˆ í–ˆì„ ë•Œ: ì—‰í„°ë¦¬ ì¶”ì¸¡
                    statusEl.innerText = "ëª¨ë¥´ê² ì–´ìš”...";
                    guessEl.innerText = "ì‘?";
                    confEl.innerText = "í™•ì‹ : 0% (í›ˆë ¨ì´ í•„ìš”í•´ìš”!)";
                } else {
                    // í›ˆë ¨ í–ˆì„ ë•Œ: ë°ì´í„° ë¹„ìœ¨ì— ë”°ë¼ ì •í™•ë„ ê²°ì •
                    // íŠ¹ì • ëª¬ìŠ¤í„° ë°ì´í„°ê°€ ì ìœ¼ë©´ í‹€ë¦´ ìˆ˜ë„ ìˆìŒ!
                    let myDataCount = collectedData[answer];
                    let chance = (myDataCount / totalData) * 100 + (100 - currentLoss); 
                    
                    // ìµœëŒ€ 99%
                    chance = Math.min(chance, 99);
                    
                    if (Math.random() * 100 < chance) {
                        // ì •ë‹µ
                        statusEl.innerText = "ì•Œì•˜ìŠµë‹ˆë‹¤! ì´ê²ƒì€...";
                        guessEl.innerText = names[answer] + "!";
                        guessEl.style.color = "#00b894";
                    } else {
                        // ì˜¤ë‹µ (ë°ì´í„° ë¶€ì¡± ì‹œ ë°œìƒ)
                        const wrongAnswer = types[Math.floor(Math.random() * types.length)];
                        statusEl.innerText = "ì–´... í—·ê°ˆë¦¬ëŠ”ë°...";
                        guessEl.innerText = names[wrongAnswer] + "?";
                        guessEl.style.color = "#d63031";
                    }
                    confEl.innerText = `í™•ì‹ : ${Math.floor(chance)}% (ë°ì´í„°: ${myDataCount}ê°œ)`;
                }
            }, 1000); // 1ì´ˆ ë’¤ ê²°ê³¼
        }

        // --- ìœ í‹¸ë¦¬í‹° ---
        function showModal(msg) {
            document.getElementById('modal-msg').innerText = msg;
            document.getElementById('alert-modal').classList.remove('hidden');
        }
        function closeModal() {
            document.getElementById('alert-modal').classList.add('hidden');
        }

    </script>
</body>
</html>
